@using Archetype.Extensions
@using Archetype.Models
@using Umbraco.Core.Models
@using RJP.MultiUrlPicker.Models
@inherits Umbraco.Web.Mvc.UmbracoTemplatePage
@{
    Layout = "_Master.cshtml";

    IPublishedContent currentPage = Model.Content;

    IEnumerable<IPublishedContent> nationalProgramsList = USDA_ARS.Umbraco.Extensions.Helpers.Nodes.NationalProgramsList();

    bool hideHeaderTitle = currentPage.GetPropertyValue<bool>("hidePageTitle");
}

@Html.Partial("~/Views/Partials/Modules/NavigationLinksSub.cshtml", currentPage)

<div id="fullPage">

    @Html.Partial("~/Views/Partials/Modules/RelatedTopicsList.cshtml", currentPage)

    <div id="pageContent">

        @if (false == hideHeaderTitle)
        {
            <table border="0" width="100%">
                <tr>
                    <td class="pageHeading">@currentPage.Name</td>
                </tr>
                <tr>
                    <td>

                        <img src="/images/headline_bar.gif" alt="headline bar" width="100%" />
                    </td>
                </tr>
            </table>
        }

        <!-- display URLs of subpages start -->
        <!--  display URLs of subpages end -->
        <!-- document content start -->

        @Html.Raw(currentPage.GetPropertyValue<string>("bodyText"))

        <!-- document content end -->


        <br>

        <table>
            <tbody>

                @if (nationalProgramsList != null && nationalProgramsList.Any())
                {
                    foreach (IPublishedContent item in nationalProgramsList)
                    {
                        <tr>
                            <td class="HdrBlackBold">
                                <a href="@item.Url">
                                    @(item.Name)
                                </a>
                            </td>
                        </tr>

                        <tr>
                            <td>
                                <img name="divider_line" alt="divider line" src="/images/content-divider.gif" width="368" height="10">
                            </td>
                        </tr>

                        <tr>
                            <td class="BodyTextBlack">
                                @foreach (IPublishedContent itemSub in item.Children.Where(p => p.DocumentTypeAlias != "SiteNavFolder"))
                                {
                                    string npCode = itemSub.GetPropertyValue<string>("npCode");
                                    <li><a href="@(itemSub.Url)">@(itemSub.Name)</a> (NP #@(npCode))</li>
                                }
                            </td>
                        </tr>

                        <tr>
                            <td>
                                <p></p>
                            </td>
                        </tr>
                    }
                }

                <tr>
                    <td><br></td>
                </tr>

            </tbody>
        </table>


    </div>
</div>