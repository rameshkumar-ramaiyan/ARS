@using Archetype.Extensions
@using Archetype.Models
@using Umbraco.Core.Models
@using RJP.MultiUrlPicker.Models
@using USDA_ARS.Umbraco.Extensions.Utilities
@using USDA_ARS.Umbraco.Extensions.Helpers.Aris
@using USDA_ARS.Umbraco.Extensions.Models.Aris
@inherits Umbraco.Web.Mvc.UmbracoTemplatePage
@{
   Layout = "_Master.cshtml";

   IPublishedContent currentPage = Model.Content;

   PeopleInfo peopleInfo = null;

   if (false == string.IsNullOrEmpty(Request.QueryString["person-id"]))
   {
      int personId = Convert.ToInt32(Request.QueryString["person-id"]);

      peopleInfo = People.GetPerson(personId);
   }

}

@Html.Partial("~/Views/Partials/Modules/NavigationLinksSub.cshtml", currentPage)

<div id="fullPage">

   @Html.Partial("~/Views/Partials/Modules/RelatedTopicsList.cshtml", currentPage)

   <div id="pageContent">

      <script language="javascript">
<!--
window.name = 'nps2000';
var remote = null;
function rs(n,u,w,h) {
remote = window.open(u, n, 'width=' + w + ',height=' + h +',refresh=yes,resizable=yes,scrollbars=yes');
if (remote != null) {
if (remote.opener == null)
remote.opener = self;
window.name = 'nps2000';
remote.location.href = u;
}
}
//-->
      </script>


      @if (peopleInfo != null)
      {

         <table width="100%" border="0">
            <tbody>
               <tr>
                  <td valign="top">
                     <b>
                        @peopleInfo.FirstName @peopleInfo.MiddleName @peopleInfo.LastName

                        @if (false == string.IsNullOrEmpty(peopleInfo.CommonName))
                        {
                           @("(" + peopleInfo.CommonName + ")")
                        }
                     </b>
                     <br />

                     <script language="JavaScript">function DisplayEmail(username, domain) { document.write(username + "&#64;" + domain); }</script>
                     <br>

                     @peopleInfo.TitleWorking<br />

                     <a href="mailto:@(peopleInfo.Email)?Subject=From ARS website">
                        @if (peopleInfo.Email != null && peopleInfo.Email.Split('@').Length == 2)
                        {
                           <script language="javascript">DisplayEmail('@(peopleInfo.Email.Split('@')[0])', '@(peopleInfo.Email.Split('@')[1])');</script>
                        }
                     </a><br>


                     Phone: @(Strings.FormatPhoneNumber(peopleInfo.PhoneAreaCode + peopleInfo.Phone))
                     @(false == string.IsNullOrEmpty(peopleInfo.PhoneExt) ? " ext. " + peopleInfo.PhoneExt : "")
                     <br />

                     Fax: @(Strings.FormatPhoneNumber(peopleInfo.FaxAreaCode + peopleInfo.Fax))<br />

                     <br />
                     @Html.Raw(false == string.IsNullOrEmpty(peopleInfo.RoomNumber) ? "Room " + peopleInfo.RoomNumber + "<br />" : "")

                     @peopleInfo.Address1<br />
                     @Html.Raw(false == string.IsNullOrWhiteSpace(peopleInfo.Address2) ? peopleInfo.Address2 + "<br />" : "")
                     @Html.Raw(false == string.IsNullOrWhiteSpace(peopleInfo.AddressBuilding) ? peopleInfo.AddressBuilding + "<br />" : "")

                     @(peopleInfo.City + ",") @peopleInfo.State @peopleInfo.PostalCode<br />


                     <p> </p>

                  </td>

               </tr>
            </tbody>
         </table>

                                          }
                                          else
                                          {
         <strong><em>The person you selected is invalid or no longer available.</em></strong>
                                          }

   </div>

</div>